# Known exploited vulnerabilities by CISA on Active Devices

### [+] Defender for Endpoint 
**Query 1**
```
let KnowExploitesVulnsCISA = externaldata(cveID: string, vendorProject: string, product: string, vulnerabilityName: string, dateAdded: datetime, shortDescription: string, requiredAction: string, dueDate: datetime, 
notes: string)[@"https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv"] with (format="csv", ignoreFirstRecord=True);
DeviceTvmSoftwareVulnerabilities
| join KnowExploitesVulnsCISA on $left.CveId == $right.cveID
| summarize
     TotalVulnerabilities = count(),
     Vulnerabilities = make_set(cveID),
     Description = make_set(shortDescription)
     by DeviceName
| sort by TotalVulnerabilities
```
**Query 2**
```
let KnowExploitesVulnsCISA = externaldata(cveID: string, vendorProject: 
string, product: string, vulnerabilityName: string, dateAdded: datetime, 
shortDescription: string, requiredAction: string, dueDate: datetime, 
notes: string)
[@"https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv"] 
with (format="csv", ignoreFirstRecord=True);
DeviceTvmSoftwareVulnerabilities
| join KnowExploitesVulnsCISA on $left.CveId == $right.cveID
| summarize
     TotalVulnerableDevices = count(),
     DeviceList = make_set(DeviceName),
     Description = make_set(shortDescription)
     by cveID
| sort by TotalVulnerableDevices
```
:exclamation: **NOT** *available in Sentinel yet.*

### [+] Description
This KQL query uses external data from CISA (Cybersecurity and Infrastructure Security Agency) to detect vulnerabilities that have been actively exploited in the past.

### [+] Recommended Actions
1. Review the list of vulnerabilities detected on each device and prioritize remediation efforts based on the severity and criticality of the vulnerabilities to the team who handles vulnerability management or patching.
2. Ensure to tell that team who is responsible to reach out to the end user to ensure that they are aware of the vulnerability and schedule a time to remediate the issue. If necessary, escalate the issue to the appropriate IT or security team.

### [+] Resources
- Forked from directly from [@Bert-JanP](https://github.com/Bert-JanP), please give him credit and a follow!
