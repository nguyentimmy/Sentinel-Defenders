# Third-Party VPN and Proxies Extensions in WebBrowsers

### [+] Defender for Endpoint 
```
DeviceTvmBrowserExtensions
| join DeviceInfo on DeviceId
| where ExtensionRisk in ('High', 'Critical')
| where ExtensionName contains "VPN" or ExtensionName contains "Proxy"
| summarize Extensions = make_set(ExtensionName), Count = dcount(ExtensionName) by DeviceName
| project DeviceName, Extensions
| sort by DeviceName desc
```

:exclamation: **NOT** *available in Sentinel yet.*

### [+] Description
Identifies potentially high-risk browser extensions that are installed on devices within your organization. It filters for browser extensions with a high or critical risk rating and searches for any extensions with the keywords "VPN" or "Proxy" in their names. The query then groups the results by the device name and summarizes the count and names of the risky extensions installed on each device

### [+] Recommended Actions
1. Recommending to contact the end user to uninstall the extensions if they are not compliant with approved software policies is a proactive measure to prevent lateral movement and any potential malicious actions that might be hidden within the extensions.

### [+] Resources
- [MITRE T1176](https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1176/T1176.md)
