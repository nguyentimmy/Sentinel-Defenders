# CVE ID Search

### [+] Defender for Endpoint 
**Query 1**
```
// Single CVE
DeviceTvmSoftwareVulnerabilities 
| where CveId contains "CVE-2021-44228" // Replace CVE ID here
| project DeviceName, CveId, VulnerabilitySeverityLevel, OSPlatform, SoftwareName, SoftwareVersion
```
**Query 2**
```
// Multiple CVE
DeviceTvmSoftwareVulnerabilities 
| where CveId in ("CVE-2021-44228", "CVE-2022-22965", "CVE-2023-28252") // Replace CVE ID here
| project DeviceName, CveId, VulnerabilitySeverityLevel, OSPlatform, SoftwareName, SoftwareVersion
```
**Query 3**
```
// Searches for each device that has the specified CVE and put into one column (Ideal to export as csv to view data)
DeviceTvmSoftwareVulnerabilities 
| where CveId in ("CVE-2021-44228", "CVE-2022-22965", "CVE-2023-28252") // Replace CVE ID here
| summarize VulnerableDevices = make_set(DeviceName) by CveId
| project CveId, VulnerableDevices
```
**Query 4**
```
// Almost the same as query 3, but instead summarizes the vulnerable devices for each CVE into a single column using the "make_set" aggregation function. 
// It then uses the "mv-expand" operator to split the "VulnerableDevices" column into multiple rows, one for each device name
DeviceTvmSoftwareVulnerabilities 
| where CveId in ("CVE-2021-44228", "CVE-2022-22965", "CVE-2023-28252") // Replace CVE ID here
| summarize VulnerableDevices = make_set(DeviceName) by CveId
| mv-expand VulnerableDevices
| extend DeviceName = tostring(VulnerableDevices)
| project CveId, DeviceName
```
:exclamation: **NOT** *available in Sentinel yet.*

### [+] Description 
Just a simple query to search for any CVE-ID you are looking for. 
