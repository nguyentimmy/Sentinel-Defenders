# Pivot Table for CVE in each Device

### [+] Defender for Endpoint 
**Query 1**
```
DeviceTvmSoftwareVulnerabilities
| project DeviceName, VulnerabilitySeverityLevel
| evaluate pivot(VulnerabilitySeverityLevel): (DeviceName: string,Critical: long, High: long, Medium: long, Low: long)
| sort by Critical, High, Medium, Lows = count(), VulnerabeCVE = make_set(CveId) by DeviceName
| sort by TotalVulnerabilities
```

:exclamation: **NOT** *available in Sentinel yet.*

### [+] Description
Creates a Pivot Table that list all CVE's on each device by count.

### [+] Recommended Actions
1. Review the list of vulnerabilities detected on each device and prioritize remediation efforts based on the severity and criticality of the vulnerabilities to the team who handles vulnerability management or patching.
2. Ensure to tell that team who is responsible to reach out to the end user to ensure that they are aware of the vulnerability and schedule a time to remediate the issue. If necessary, escalate the issue to the appropriate IT or security team.

### [+] Resources
- Forked from directly from [@Bert-JanP](https://github.com/Bert-JanP), please give him credit and a follow!
